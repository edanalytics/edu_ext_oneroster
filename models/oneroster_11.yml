version: 2
models:
  - name: oneroster__manifest
    config: 
      tags: ['oneroster_1.1']
  - name: oneroster__academic_sessions
    config: 
      tags: ['oneroster_1.1']
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - sourcedId 
            - TENANT_CODE
          quote_columns: true
  - name: oneroster__classes
    config: 
      tags: ['oneroster_1.1']
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - sourcedId 
            - TENANT_CODE
          quote_columns: true
    columns: 
      - name: courseSourcedId
        quote: true
        tests:
          - relationships:
              to: ref('oneroster__courses')
              field: '"sourcedId"'
      - name: schoolSourcedId
        quote: true
        tests:
          - relationships: 
              to: ref('oneroster__orgs')
              field: '"sourcedId"'
  - name: oneroster__courses
    config: 
      tags: ['oneroster_1.1']
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - sourcedId 
            - TENANT_CODE
          quote_columns: true
    columns: 
      - name: orgSourcedId
        quote: true
        tests:
          - relationships: 
              to: ref('oneroster__orgs')
              field: '"sourcedId"'
      - name: schoolYearSourcedId
        quote: true
        tests:
          - relationships: 
              to: ref('oneroster__academic_sessions')
              field: '"sourcedId"'
  - name: oneroster__enrollments
    config: 
      tags: ['oneroster_1.1']
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - sourcedId 
            - TENANT_CODE
          quote_columns: true
    columns: 
      - name: classSourcedId
        quote: true
        tests:
          - relationships: 
              to: ref('oneroster__classes')
              field: '"sourcedId"'
      - name: schoolSourcedId
        quote: true
        tests:
          - relationships: 
              to: ref('oneroster__orgs')
              field: '"sourcedId"'
      - name: userSourcedId
        quote: true
        tests:
          - relationships: 
              to: ref('oneroster__users')
              field: '"sourcedId"'
  - name: oneroster__orgs
    config: 
      tags: ['oneroster_1.1']
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - sourcedId 
            - TENANT_CODE
          quote_columns: true
  - name: oneroster__users
    config: 
      tags: ['oneroster_1.1']
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - sourcedId 
            - TENANT_CODE
          quote_columns: true